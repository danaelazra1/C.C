<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
   
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <style>   
        body {  /* עיצוב רקע */    
           background-image:url("images/cartBack.jpg");
           background-size:auto;
           background-origin: padding-box;
           background-repeat:no-repeat;
           background-position: center;
           background-size:cover;
        }

        body { /* עיצוב רקע */    
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .cart-container { /* עיצוב הריבוע של העגלת קניות  */    
            position: absolute;
            top: 65%;
            left: 55%;
            transform: translate(-50%, -50%);
        }

        .cart-container p{ /* עיצוב הכותרת */    
            color: rgba(62, 19, 22, 0.753);
            font-size:79px;
            margin-bottom: 25px;
            text-align: center;
            font-family: serif;
            font-weight: bold;
            margin-right: 45px;
            margin-top: 10px;
        }

        .cart { /* עיצוב הריבוע של הפרטים */    
            width: 300px;
            padding: 35px;
            background-color: rgba(255, 222, 173, 0.24);
            border: 1px solid #000000;
            border-radius: 8px;
            margin-left: 40px;
            display: grid;
            display: grid;
             grid-template-columns: auto auto auto;
        }
        
        
        .cart-item h5{ /* עיצוב הטקסט בתוך התיבה */    
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .cart-item img{ /* עיצוב תמונה בתוך התיבה */    
            border-radius: 8px;
            border: 1px solid #ddd;
            width: 30%;
            height: 30%;
            padding: 5px;
        }
        .cart-item img:hover{
            box-shadow: 0 0 2px 1px rgba(0, 140, 186, 0.5);
        }
        
        .cart-item p { /* עיצוב מחיר בתוך התיבה */    
            flex-grow: 1;
            font-weight: bold;
            font-size: medium;
            font-family: serif ;
        }
        
        
        .cart-total { /* עיצוב שורת המחיר של כל העגלה */    
            margin-top: 10px;
            font-weight: bold;
            text-align: center;
        }
    </style>

    <script>
        $(document).ready(function(){
            loadProducts();
            $('.quantityPlus').on('click',function(event){
            // event.preventDefault();
            console.log("Clicked proccessed")
                $.ajax({
                url : "/addProduct",
                method: "POST",
                data : {productID: $(this).val()},
                success : function(res){
                alert("Product added to cart")
                }
                })
        })
            $('.quantityMinus').on('click',function(event){
                // event.preventDefault();
                console.log("Clicked proccessed")
                    $.ajax({
                    url : "/removeProduct",
                    method : "POST",
                    data : {ProductID : $(this).val()},
                    success : function(res){
                    alert("Product removed from cart")
                    // $('.cart-item').each(function(index){

                    // })
                    }
                    })
            })
    
    })
        function loadProducts(){
            $('.cart').empty();
            $.ajax({
                method: "POST",
                url: "/cart",
                success : function(res){
                    res.products.forEach(product => {
                      let item = $('<div class="cart-item"></div>');
                      let img = $('<img src='+product.Picture+' class="card-img-top">')
                      let name = $('<h5 class="card-title">'+product.ProductName+'</h5>')
                       let price = $('<p class="card-text">'+product.Price+'</p>')
                       let plus = $('<button  value="'+product.id+'" class="btn btn-primary quantityPlus"> + </button>')
                        let minus = $('<button  value="'+product.id+'" class="btn btn-primary quantityMinus"> - </button>')
                       item.append([img,name,price,plus,minus]);
                    $('.cart').append(item);
                     });
                     let cartPrice = $('<div id="cart-total" class="cart-total">'+res.price+' </div>')
                     $('.cart').append(cartPrice);
                }
            })
        }
    </script>
</head>

<head>
    <meta charset="UTF-8">
</head>
<body>
    <div class="cart-container">
        <p>Shopping Cart</p>
            <div class="cart">
            </div>
                <form action="/purchaseCart" method="post">
                    <button type="submit" class="btn btn-primary">Purchase</button>
                </form>
            </div>
    </div>
</body>
</html>














